<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Neon Globe</title>

<style>
html, body {
    margin: 0;
    width: 100%;
    height: 100%;
    background: transparent;
    overflow: hidden;
    cursor: grab;

    /* ðŸ”‘ CENTER FIX */
    display: flex;
    align-items: center;
    justify-content: center;
}

body:active { cursor: grabbing; }

canvas {
    display: block;
}
</style>
</head>

<body>

<script src="https://cdn.jsdelivr.net/npm/three@0.152.2/build/three.min.js"></script>

<script>
/* ================= SCENE ================= */
const scene = new THREE.Scene();

/* ================= CAMERA ================= */
const camera = new THREE.PerspectiveCamera(60, 1, 0.1, 1000);
camera.position.z = 2.9;   // ðŸ”‘ stable framing

/* ================= RENDERER ================= */
const renderer = new THREE.WebGLRenderer({
    antialias: true,
    alpha: true
});
renderer.setPixelRatio(window.devicePixelRatio);
renderer.outputColorSpace = THREE.SRGBColorSpace;
document.body.appendChild(renderer.domElement);

/* ================= LIGHTS ================= */
scene.add(new THREE.AmbientLight(0xffffff, 0.5));

const rimLight = new THREE.PointLight(0x00ffff, 0.5, 6);
rimLight.position.set(0, 0, 4);
scene.add(rimLight);

/* ================= TEXTURE ================= */
const loader = new THREE.TextureLoader();
const earthTexture = loader.load("world_map.png");

/* ================= EARTH ================= */
const earth = new THREE.Mesh(
  new THREE.SphereGeometry(1, 64, 64),
  new THREE.MeshStandardMaterial({
    map: earthTexture,
    emissive: 0x002a2e,
    emissiveIntensity: 0.08,
    roughness: 1
  })
);
scene.add(earth);

/* ================= GLOW SHELL ================= */
const glowShell = new THREE.Mesh(
  new THREE.SphereGeometry(1.04, 64, 64),
  new THREE.MeshBasicMaterial({
    color: 0x00ffff,
    transparent: true,
    opacity: 0.12,
    blending: THREE.AdditiveBlending,
    side: THREE.BackSide
  })
);
scene.add(glowShell);

/* ================= ROTATION ================= */
let isDragging = false;
let prev = { x: 0, y: 0 };
let velX = 0, velY = 0;

const dragSpeed = 0.008;
const friction = 0.95;
const autoRotateSpeed = 0.02;

/* ================= MOUSE ================= */
document.addEventListener("mousedown", e => {
  isDragging = true;
  prev.x = e.clientX;
  prev.y = e.clientY;
});
document.addEventListener("mouseup", () => isDragging = false);
document.addEventListener("mousemove", e => {
  if (!isDragging) return;
  velY = (e.clientX - prev.x) * dragSpeed;
  velX = (e.clientY - prev.y) * dragSpeed;
  prev.x = e.clientX;
  prev.y = e.clientY;
});

/* ================= RESIZE (CRITICAL FIX) ================= */
function resize() {
  const size = Math.min(
    document.body.clientWidth,
    document.body.clientHeight
  );

  renderer.setSize(size, size, false);
  camera.aspect = 1;
  camera.updateProjectionMatrix();
}
window.addEventListener("resize", resize);
resize();

/* ================= ANIMATION ================= */
function animate() {
  requestAnimationFrame(animate);

  if (!isDragging) {
    velX *= friction;
    velY *= friction;
  }

  earth.rotation.y += velY + autoRotateSpeed;
  earth.rotation.x += velX;
  glowShell.rotation.copy(earth.rotation);

  renderer.render(scene, camera);
}
animate();
</script>

</body>
</html>
